stages:
  - deploy

deploy_job:
  stage: deploy
  tags:
    - docker
  script: |
    set -euxo pipefail

    echo "ğŸ“‚ Moving to project directory..."
    cd /home/cartalex-final/Cartalex

    echo "ğŸ”„ Fetching latest code from main branch..."
    git fetch origin main
    git reset --hard origin/main

    echo "ğŸ›‘ Stopping existing containers..."
    docker compose down

    echo "ğŸ—ï¸ Rebuilding and starting containers..."
    docker compose up -d --build

    echo "âœ… Deployment completed successfully!"
